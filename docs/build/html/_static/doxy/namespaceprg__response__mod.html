<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>progress: prg_response_mod Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">progress
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
   <div id="projectbrief">Progress Library ;A library for solvers used in quantum chemistry packages</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespaceprg__response__mod.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">prg_response_mod Module Reference<div class="ingroups"><a class="el" href="group__PROGRESS.html">(PROGRESS related routines)</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Module to compute the density matrix response and related quantities.  
<a href="namespaceprg__response__mod.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">type &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structprg__response__mod_1_1respdata__type.html">respdata_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a45578418504766e2235a5fe6cf4fc9d5"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a45578418504766e2235a5fe6cf4fc9d5">prg_parse_response</a> (RespData, filename)</td></tr>
<tr class="memdesc:a45578418504766e2235a5fe6cf4fc9d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The parser for the calculation of the DM response.  <a href="namespaceprg__response__mod.html#a45578418504766e2235a5fe6cf4fc9d5">More...</a><br /></td></tr>
<tr class="separator:a45578418504766e2235a5fe6cf4fc9d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f297b3ba85d4c7ca3ce22351a861491"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a3f297b3ba85d4c7ca3ce22351a861491">prg_compute_dipole</a> (charges, coordinate, dipoleMoment, factor, verbose)</td></tr>
<tr class="memdesc:a3f297b3ba85d4c7ca3ce22351a861491"><td class="mdescLeft">&#160;</td><td class="mdescRight">To compute the dipole moment of the system. The units of the dipole moment are determined by the units of the coordinates and charges that are given.  <a href="namespaceprg__response__mod.html#a3f297b3ba85d4c7ca3ce22351a861491">More...</a><br /></td></tr>
<tr class="separator:a3f297b3ba85d4c7ca3ce22351a861491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a558711d6f3342ea57458617c25c8b05c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a558711d6f3342ea57458617c25c8b05c">prg_write_dipole_tcl</a> (dipoleMoment, file, factor, verbose)</td></tr>
<tr class="memdesc:a558711d6f3342ea57458617c25c8b05c"><td class="mdescLeft">&#160;</td><td class="mdescRight">To visualize a dipole moment using VMD. This will prg_generate a .tcl script that could be run using VMD To visualize with VMD: $ vmd -e dipole.tcl.  <a href="namespaceprg__response__mod.html#a558711d6f3342ea57458617c25c8b05c">More...</a><br /></td></tr>
<tr class="separator:a558711d6f3342ea57458617c25c8b05c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f646799139693fe897b35838af755a5"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a9f646799139693fe897b35838af755a5">prg_compute_polarizability</a> (rsp_bml, prt_bml, polarizability, factor, verbose)</td></tr>
<tr class="memdesc:a9f646799139693fe897b35838af755a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">To compute the polarizability of the system. The units of the directional polarizability are determined by the units of the perturbation and Hamiltonian. This equation can be found in <a class="el" href="citelist.html#CITEREF_Weber2005">[5]</a> equation 4a. Note that in equation 4a of the reference there is a 2 that account for the double occupancy which is not present in this case cause the density matrix construction is done by taking the occupancy into account.  <a href="namespaceprg__response__mod.html#a9f646799139693fe897b35838af755a5">More...</a><br /></td></tr>
<tr class="separator:a9f646799139693fe897b35838af755a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6387373bee0a849be23b033fb6e06a9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#ad6387373bee0a849be23b033fb6e06a9">prg_pert_from_file</a> (prt_bml, norb)</td></tr>
<tr class="memdesc:ad6387373bee0a849be23b033fb6e06a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read perturbation from file.  <a href="namespaceprg__response__mod.html#ad6387373bee0a849be23b033fb6e06a9">More...</a><br /></td></tr>
<tr class="separator:ad6387373bee0a849be23b033fb6e06a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19fcc99dd54ee589e329765a28dfe306"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a19fcc99dd54ee589e329765a28dfe306">prg_compute_response_rs</a> (ham_bml, prt_bml, rsp_bml, lambda, bndfil, threshold, verbose)</td></tr>
<tr class="memdesc:a19fcc99dd54ee589e329765a28dfe306"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the first order response density matrix using Rayleigh Schrodinger Perturbation theory The transformation hereby performed are:  <a href="namespaceprg__response__mod.html#a19fcc99dd54ee589e329765a28dfe306">More...</a><br /></td></tr>
<tr class="separator:a19fcc99dd54ee589e329765a28dfe306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9ac4cf1d2e0cbc25e8a1efb94bd5b1a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#aa9ac4cf1d2e0cbc25e8a1efb94bd5b1a">prg_compute_response_fd</a> (ham_bml, prt_bml, rsp_bml, prg_delta, bndfil, threshold, verbose)</td></tr>
<tr class="memdesc:aa9ac4cf1d2e0cbc25e8a1efb94bd5b1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the first order response density matrix using finite differences. The transformation hereby performed are:  <a href="namespaceprg__response__mod.html#aa9ac4cf1d2e0cbc25e8a1efb94bd5b1a">More...</a><br /></td></tr>
<tr class="separator:aa9ac4cf1d2e0cbc25e8a1efb94bd5b1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae67248cd406e1608ec7383128aae8d95"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#ae67248cd406e1608ec7383128aae8d95">prg_pert_constant_field</a> (field, intensity, coordinate, lambda, prt_bml, threshold, spindex, norbi, verbose, over_bml)</td></tr>
<tr class="memdesc:ae67248cd406e1608ec7383128aae8d95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a constant field perturbation through the dipole moment operator ( \( \hat{\mu} = e \hat{\textbf{r}} \)). In the matrix representation, this is: \( H^{(1)} = \lambda \frac{1}{2}(\,S \, e \textbf{r} \cdot \textbf{E} + \, e \textbf{r} \cdot \textbf{E}S) \). The symmetrization is done in order to preserve the Hermiticity of H. In this case the whole system will be affected by the field. In a latter version we will add the possibility of applying this field to a region of the system. In this implementation \( e= 1 \) and units can be transformed by using the parameter \( \lambda \).  <a href="namespaceprg__response__mod.html#ae67248cd406e1608ec7383128aae8d95">More...</a><br /></td></tr>
<tr class="separator:ae67248cd406e1608ec7383128aae8d95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa81110bed4e09f0f488040123b5a7458"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#aa81110bed4e09f0f488040123b5a7458">prg_pert_sin_pot</a> (direction, lx, coordinate, lambda, prt_bml, threshold, spindex, norbi, verbose, over_bml)</td></tr>
<tr class="memdesc:aa81110bed4e09f0f488040123b5a7458"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a sinusoidal length dependent potential ( \( \sin(\tilde{\textbf{r}}_x) \)) where \( \textbf{r}_x \) is the x coordinate. The Hamiltonian gets modified as follows: \( H^{(1)} = \frac{1}{2}\lambda (S \sin(\tilde{\textbf{r}}_x) + \sin(\tilde{\textbf{r}}_x) S) \). \( \tilde{\textbf{r}}_x = 2\pi(\textbf{r}/l_x) - \pi \). The symmetrization is done in order to preserve the Hermiticity of H. Units can be transformed by using the parameter \( \lambda \).  <a href="namespaceprg__response__mod.html#aa81110bed4e09f0f488040123b5a7458">More...</a><br /></td></tr>
<tr class="separator:aa81110bed4e09f0f488040123b5a7458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4e29c003754cd1a80ca97f973c9e040"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#ac4e29c003754cd1a80ca97f973c9e040">prg_pert_cos_pot</a> (direction, lx, coordinate, lambda, prt_bml, threshold, spindex, norbi, verbose, over_bml)</td></tr>
<tr class="memdesc:ac4e29c003754cd1a80ca97f973c9e040"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a cosine length dependent potential ( \( \cos(\tilde{\textbf{r}}_x) \)) where \( \textbf{r}_x \) is the x coordinate. The Hamiltonian gets modified as follows: \( H^{(1)} = \frac{1}{2}\lambda (S \sin(\tilde{\textbf{r}}_x) + \sin(\tilde{\textbf{r}}_x) S) \). \( \tilde{\textbf{r}}_x = 2\pi(\textbf{r}/l_x) - \pi \). The symmetrization is done in order to preserve the Hermiticity of H. Units can be transformed by using the parameter \( \lambda \).  <a href="namespaceprg__response__mod.html#ac4e29c003754cd1a80ca97f973c9e040">More...</a><br /></td></tr>
<tr class="separator:ac4e29c003754cd1a80ca97f973c9e040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09362fd552f1e7cc86c1394836a67a3"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#aa09362fd552f1e7cc86c1394836a67a3">prg_compute_response_sp2</a> (ham_bml, prt_bml, rsp_bml, rho_bml, lambda, bndfil, minsp2iter, maxsp2iter, sp2conv, idemtol, threshold, verbose)</td></tr>
<tr class="memdesc:aa09362fd552f1e7cc86c1394836a67a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the first order response matrix from a Hamiltonian matrix.  <a href="namespaceprg__response__mod.html#aa09362fd552f1e7cc86c1394836a67a3">More...</a><br /></td></tr>
<tr class="separator:aa09362fd552f1e7cc86c1394836a67a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f0b5ad483a44861c9027f2d52bc947c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a0f0b5ad483a44861c9027f2d52bc947c">prg_project_response</a> (rsp_bml, over_bml, spindex, norbi, coordinates, rspfunc, verbose)</td></tr>
<tr class="memdesc:a0f0b5ad483a44861c9027f2d52bc947c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Project the response onto atomic positions. First order response to the perturbation ( \( \rho^{(1)} \)) projected onto the atomic position. Basically: \( rsp(i) = \sum_{\alpha \in i}\rho^{(1)}_{\alpha \alpha} \), where orbital \( \alpha \) belong to atom \( i \).  <a href="namespaceprg__response__mod.html#a0f0b5ad483a44861c9027f2d52bc947c">More...</a><br /></td></tr>
<tr class="separator:a0f0b5ad483a44861c9027f2d52bc947c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42d17df4da2ac276ba79e1ecee1eb7af"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a42d17df4da2ac276ba79e1ecee1eb7af">prg_canon_response_vector</a> (P1_bml, H1_bml, Nocc, beta, evals, mu0, m, thresh, HDIM)</td></tr>
<tr class="memdesc:a42d17df4da2ac276ba79e1ecee1eb7af"><td class="mdescLeft">&#160;</td><td class="mdescRight">First-order Canonical Density Matrix Perturbation Theory.  <a href="namespaceprg__response__mod.html#a42d17df4da2ac276ba79e1ecee1eb7af">More...</a><br /></td></tr>
<tr class="separator:a42d17df4da2ac276ba79e1ecee1eb7af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce378af9f81831f51f63a7ffc132a01"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a0ce378af9f81831f51f63a7ffc132a01">prg_canon_response</a> (P1_bml, H1_bml, Nocc, beta, evals, mu0, m, HDIM)</td></tr>
<tr class="memdesc:a0ce378af9f81831f51f63a7ffc132a01"><td class="mdescLeft">&#160;</td><td class="mdescRight">First-order Canonical Density Matrix Perturbation Theory.  <a href="namespaceprg__response__mod.html#a0ce378af9f81831f51f63a7ffc132a01">More...</a><br /></td></tr>
<tr class="separator:a0ce378af9f81831f51f63a7ffc132a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09dfdf45270a4a8b323d5dcc466d3d62"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a09dfdf45270a4a8b323d5dcc466d3d62">prg_canon_response_orig</a> (P1_bml, H1_bml, Nocc, beta, evals, mu0, m, thresh, HDIM)</td></tr>
<tr class="memdesc:a09dfdf45270a4a8b323d5dcc466d3d62"><td class="mdescLeft">&#160;</td><td class="mdescRight">First-order Canonical Density Matrix Perturbation Theory.  <a href="namespaceprg__response__mod.html#a09dfdf45270a4a8b323d5dcc466d3d62">More...</a><br /></td></tr>
<tr class="separator:a09dfdf45270a4a8b323d5dcc466d3d62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53c2047a342b62d1cc5d8d050ca8a5fd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a53c2047a342b62d1cc5d8d050ca8a5fd">prg_canon_response_p1_dpdmu</a> (P1_bml, dPdMu, H1_bml, Norbs, beta, Q_bml, evals, mu0, m, HDIM)</td></tr>
<tr class="memdesc:a53c2047a342b62d1cc5d8d050ca8a5fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">First-order Canonical Density Matrix Perturbation Theory.  <a href="namespaceprg__response__mod.html#a53c2047a342b62d1cc5d8d050ca8a5fd">More...</a><br /></td></tr>
<tr class="separator:a53c2047a342b62d1cc5d8d050ca8a5fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af4d04d47039bc578b2566855bdc94a1e"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a> = kind(1.0d0)</td></tr>
<tr class="separator:af4d04d47039bc578b2566855bdc94a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11f1b497aa371e1f745c7cf01766665c"><td class="memItemLeft" align="right" valign="top">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceprg__response__mod.html#a11f1b497aa371e1f745c7cf01766665c">pi</a> = 3.14159265358979323846264338327950_dp</td></tr>
<tr class="separator:a11f1b497aa371e1f745c7cf01766665c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module to compute the density matrix response and related quantities. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd><p class="startdd">Add the response scf </p>
<p class="interdd">Change name response_SP2 to dm_prt_response </p>
<p class="enddd">Change name response_rs to rs_prt_response </p>
</dd></dl>
<p>More information about the theory can be found at <a class="el" href="citelist.html#CITEREF_Niklasson2005">[3]</a> and Niklasson2015 </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a0ce378af9f81831f51f63a7ffc132a01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ce378af9f81831f51f63a7ffc132a01">&#9670;&nbsp;</a></span>prg_canon_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_canon_response </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>P1_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>H1_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Nocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(hdim), intent(in)&#160;</td>
          <td class="paramname"><em>evals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mu0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>HDIM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>First-order Canonical Density Matrix Perturbation Theory. </p>
<p>Assuming known mu0 and representation in H0's eigenbasis Q, where H0 and P0 become diagonal. (mu0, eigenvalues e and eigenvectors Q of H0 are assumed known) Based on PRL 92, 193001 (2004) and PRE 92, 063301 (2015). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P1_bml</td><td>First-order canonical response output. </td></tr>
    <tr><td class="paramname">H1_bml</td><td>Perturbative hamiltonian input. </td></tr>
    <tr><td class="paramname">Nocc</td><td>Number of ocupied orbitals. </td></tr>
    <tr><td class="paramname">beta</td><td>Inverse electronic temperature. </td></tr>
    <tr><td class="paramname">evals</td><td>Eigenvalues of the system. </td></tr>
    <tr><td class="paramname">mu0</td><td>Chemical potential. </td></tr>
    <tr><td class="paramname">m</td><td>Number of recursive steps. </td></tr>
    <tr><td class="paramname">HDIM</td><td>Number of orbitals - Hamiltonina zise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00948">948</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a09dfdf45270a4a8b323d5dcc466d3d62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09dfdf45270a4a8b323d5dcc466d3d62">&#9670;&nbsp;</a></span>prg_canon_response_orig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_canon_response_orig </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>P1_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>H1_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Nocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(hdim), intent(in)&#160;</td>
          <td class="paramname"><em>evals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mu0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>HDIM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>First-order Canonical Density Matrix Perturbation Theory. </p>
<p>Assuming known mu0 and representation in H0's eigenbasis Q, where H0 and P0 become diagonal. Original routine. (mu0, eigenvalues e and eigenvectors Q of H0 are assumed known) Based on PRL 92, 193001 (2004) and PRE 92, 063301 (2015). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P1_bml</td><td>First-order canonical response output. </td></tr>
    <tr><td class="paramname">H1_bml</td><td>Perturbative hamiltonian input. </td></tr>
    <tr><td class="paramname">Nocc</td><td>Number of ocupied orbitals. </td></tr>
    <tr><td class="paramname">beta</td><td>Inverse electronic temperature. </td></tr>
    <tr><td class="paramname">evals</td><td>Eigenvalues of the system. </td></tr>
    <tr><td class="paramname">mu0</td><td>Chemical potential. </td></tr>
    <tr><td class="paramname">m</td><td>Number of recursive steps. </td></tr>
    <tr><td class="paramname">HDIM</td><td>Number of orbitals - Hamiltonina zise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l01039">1039</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a53c2047a342b62d1cc5d8d050ca8a5fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53c2047a342b62d1cc5d8d050ca8a5fd">&#9670;&nbsp;</a></span>prg_canon_response_p1_dpdmu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_canon_response_p1_dpdmu </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>P1_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(hdim), intent(inout)&#160;</td>
          <td class="paramname"><em>dPdMu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>H1_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>Norbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t)&#160;</td>
          <td class="paramname"><em>Q_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(hdim), intent(in)&#160;</td>
          <td class="paramname"><em>evals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mu0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>HDIM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>First-order Canonical Density Matrix Perturbation Theory. </p>
<p>Assuming known mu0 and representation in H0's eigenbasis Q, where H0 and P0 become diagonal. (mu0, eigenvalues e and eigenvectors Q of H0 are assumed known) Based on PRL 92, 193001 (2004) and PRE 92, 063301 (2015) </p>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l01113">1113</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a42d17df4da2ac276ba79e1ecee1eb7af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42d17df4da2ac276ba79e1ecee1eb7af">&#9670;&nbsp;</a></span>prg_canon_response_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_canon_response_vector </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>P1_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>H1_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Nocc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(hdim), intent(in)&#160;</td>
          <td class="paramname"><em>evals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mu0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>HDIM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>First-order Canonical Density Matrix Perturbation Theory. </p>
<p>Assuming known mu0 and representation in H0's eigenbasis Q, where H0 and P0 become diagonal. (mu0, eigenvalues e and eigenvectors Q of H0 are assumed known) Based on PRL 92, 193001 (2004) and PRE 92, 063301 (2015). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P1_bml</td><td>First-order canonical response output. </td></tr>
    <tr><td class="paramname">H1_bml</td><td>Perturbative hamiltonian input. </td></tr>
    <tr><td class="paramname">Nocc</td><td>Number of ocupied orbitals. </td></tr>
    <tr><td class="paramname">beta</td><td>Inverse electronic temperature. </td></tr>
    <tr><td class="paramname">evals</td><td>Eigenvalues of the system. </td></tr>
    <tr><td class="paramname">mu0</td><td>Chemical potential. </td></tr>
    <tr><td class="paramname">m</td><td>Number of recursive steps. </td></tr>
    <tr><td class="paramname">HDIM</td><td>Number of orbitals - Hamiltonina zise. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00850">850</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a3f297b3ba85d4c7ca3ce22351a861491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f297b3ba85d4c7ca3ce22351a861491">&#9670;&nbsp;</a></span>prg_compute_dipole()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_compute_dipole </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>charges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>coordinate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(3), intent(inout)&#160;</td>
          <td class="paramname"><em>dipoleMoment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To compute the dipole moment of the system. The units of the dipole moment are determined by the units of the coordinates and charges that are given. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">charges</td><td>Charges on each atomic position. </td></tr>
    <tr><td class="paramname">coordinate</td><td>Coordinates of the atoms. </td></tr>
    <tr><td class="paramname">nats</td><td>Number of atoms. </td></tr>
    <tr><td class="paramname">dipoleMoment</td><td>Dipole moment vector. </td></tr>
    <tr><td class="paramname">factor</td><td>Unit conversion factor (use 1.0 is no conversion is required). </td></tr>
    <tr><td class="paramname">verbose</td><td>To give different verbosity levels. If coordinates are in \( \AA \) and charges are in fractions of electron, then transformation ea2debye form LATTE lib can be used to change units to Debye. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00123">123</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a9f646799139693fe897b35838af755a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f646799139693fe897b35838af755a5">&#9670;&nbsp;</a></span>prg_compute_polarizability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_compute_polarizability </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>rsp_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>prt_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>polarizability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To compute the polarizability of the system. The units of the directional polarizability are determined by the units of the perturbation and Hamiltonian. This equation can be found in <a class="el" href="citelist.html#CITEREF_Weber2005">[5]</a> equation 4a. Note that in equation 4a of the reference there is a 2 that account for the double occupancy which is not present in this case cause the density matrix construction is done by taking the occupancy into account. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">charges</td><td>Charges on each atomic position. </td></tr>
    <tr><td class="paramname">coordinate</td><td>Coordinates of the atoms. </td></tr>
    <tr><td class="paramname">nats</td><td>Number of atoms. </td></tr>
    <tr><td class="paramname">dipoleMoment</td><td>Dipole moment vector. </td></tr>
    <tr><td class="paramname">factor</td><td>Unit conversion factor (use 1.0 is no conversion is required). </td></tr>
    <tr><td class="paramname">verbose</td><td>To give different verbosity levels. If coordinates are in \( \AA \) and charges are in fractions of electron, then transformation ea2debye form LATTE lib can be used to change units to Debye. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00201">201</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="aa9ac4cf1d2e0cbc25e8a1efb94bd5b1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9ac4cf1d2e0cbc25e8a1efb94bd5b1a">&#9670;&nbsp;</a></span>prg_compute_response_fd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_compute_response_fd </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>ham_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>prt_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>rsp_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>prg_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>bndfil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the first order response density matrix using finite differences. The transformation hereby performed are: </p>
<ul>
<li>\( H^+ = H^{(0)} + \delta H^{(1)} \)</li>
<li>\( H^- = H^{(0)} - \delta H^{(1)} \)</li>
<li>\( \rho^+ = f(H^+) \)</li>
<li>\( \rho^- = f(H^-) \)</li>
<li>\( \rho^{(1)} = (\rho^+ - \rho^-)/(2\delta) \). Where f denotes the Fermi function (construction of the density matrix) <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ham_bml</td><td>Hamiltonian in bml format ( \( H^{(0)} \)). </td></tr>
    <tr><td class="paramname">prt_bml</td><td>Perturbation in bml format ( \( H^{(1)} \)). </td></tr>
    <tr><td class="paramname">rsp_bml</td><td>First order response to the perturbation ( \( \rho^{(1)} \)). </td></tr>
    <tr><td class="paramname">bndfil</td><td>Filing factor. </td></tr>
    <tr><td class="paramname">threshold</td><td>Threshold value for matrix elements. </td></tr>
    <tr><td class="paramname">verbose</td><td>Different levels of verbosity. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This works only for the prg_orthogonalized form of ham_bml. </dd>
<dd>
The response must be in the prg_orthogonalized form. </dd></dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00382">382</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a19fcc99dd54ee589e329765a28dfe306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19fcc99dd54ee589e329765a28dfe306">&#9670;&nbsp;</a></span>prg_compute_response_rs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_compute_response_rs </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>ham_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>prt_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>rsp_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>bndfil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the first order response density matrix using Rayleigh Schrodinger Perturbation theory The transformation hereby performed are: </p>
<ul>
<li>\( V = C^{\dagger} H^{(1)} C \)</li>
<li>\( \tilde{V}_{ij} = \frac{V_{ij}}{\epsilon_j - \epsilon_i} \), with \( \tilde{V}_{ii} = 0 \, \forall i \).</li>
<li>\( C^{(1)} = C \tilde{V} \)</li>
<li>And finally: \( \rho^{(1)} = Cf(C^{(1)})^{\dagger} + C^{(1)}fC^{\dagger}\) <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ham_bml</td><td>Hamiltonian in bml format ( \( H^{(0)} \)). </td></tr>
    <tr><td class="paramname">prt_bml</td><td>Perturbation in bml format ( \( H^{(1)} \)). </td></tr>
    <tr><td class="paramname">rsp_bml</td><td>First order response to the perturbation ( \( \rho^{(1)} \)). </td></tr>
    <tr><td class="paramname">bndfil</td><td>Filing factor. </td></tr>
    <tr><td class="paramname">threshold</td><td>Threshold value for matrix elements. </td></tr>
    <tr><td class="paramname">verbose</td><td>Different levels of verbosity. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This works only for the prg_orthogonalized form of ham_bml. </dd>
<dd>
The response must be in the prg_orthogonalized form. </dd></dl>
</li>
</ul>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00252">252</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="aa09362fd552f1e7cc86c1394836a67a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa09362fd552f1e7cc86c1394836a67a3">&#9670;&nbsp;</a></span>prg_compute_response_sp2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_compute_response_sp2 </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>ham_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>prt_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>rsp_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>rho_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>bndfil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>minsp2iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>maxsp2iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>sp2conv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>idemtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the first order response matrix from a Hamiltonian matrix. </p>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00655">655</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a45578418504766e2235a5fe6cf4fc9d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45578418504766e2235a5fe6cf4fc9d5">&#9670;&nbsp;</a></span>prg_parse_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_parse_response </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structprg__response__mod_1_1respdata__type.html">respdata_type</a>)&#160;</td>
          <td class="paramname"><em>RespData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*)&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The parser for the calculation of the DM response. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">RespData</td><td>Response data type. </td></tr>
    <tr><td class="paramname">filename</td><td>Name of the file to parse. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00046">46</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="ae67248cd406e1608ec7383128aae8d95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae67248cd406e1608ec7383128aae8d95">&#9670;&nbsp;</a></span>prg_pert_constant_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_pert_constant_field </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>intensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>coordinate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>prt_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>spindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>norbi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(in), optional&#160;</td>
          <td class="paramname"><em>over_bml</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a constant field perturbation through the dipole moment operator ( \( \hat{\mu} = e \hat{\textbf{r}} \)). In the matrix representation, this is: \( H^{(1)} = \lambda \frac{1}{2}(\,S \, e \textbf{r} \cdot \textbf{E} + \, e \textbf{r} \cdot \textbf{E}S) \). The symmetrization is done in order to preserve the Hermiticity of H. In this case the whole system will be affected by the field. In a latter version we will add the possibility of applying this field to a region of the system. In this implementation \( e= 1 \) and units can be transformed by using the parameter \( \lambda \). </p>
<dl class="section note"><dt>Note</dt><dd>If the Hamiltonian is already in the prg_orthogonalized form, then parameter over_bml can be omitted. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>Direction of the applied field ( \( \hat{\textbf{E}} \)). </td></tr>
    <tr><td class="paramname">intensity</td><td>Intensity of the field ( \( ||\textbf{E}|| \)).. </td></tr>
    <tr><td class="paramname">coordinate</td><td>Coordinates of the system ( \( \textbf{r}\)). </td></tr>
    <tr><td class="paramname">lambda</td><td>Constant to premultiply the perturbation ( \( \lambda\)). </td></tr>
    <tr><td class="paramname">prt_bml</td><td>Perturbation in bml format ( \( H^{(1)} \)). </td></tr>
    <tr><td class="paramname">threshold</td><td>Threshold value for bml format matrices. </td></tr>
    <tr><td class="paramname">spindex</td><td>Species index. It gives the species index of a particular atom. </td></tr>
    <tr><td class="paramname">norbi</td><td>Number of orbitals for each atomic site. </td></tr>
    <tr><td class="paramname">verbose</td><td>Different levels of verbosity. </td></tr>
    <tr><td class="paramname">over_bml</td><td>It has to be present for a nonorthogonal representation ( \( S \)). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00449">449</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="ac4e29c003754cd1a80ca97f973c9e040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4e29c003754cd1a80ca97f973c9e040">&#9670;&nbsp;</a></span>prg_pert_cos_pot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_pert_cos_pot </td>
          <td>(</td>
          <td class="paramtype">character&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>lx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>coordinate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>prt_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>spindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>norbi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(in), optional&#160;</td>
          <td class="paramname"><em>over_bml</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a cosine length dependent potential ( \( \cos(\tilde{\textbf{r}}_x) \)) where \( \textbf{r}_x \) is the x coordinate. The Hamiltonian gets modified as follows: \( H^{(1)} = \frac{1}{2}\lambda (S \sin(\tilde{\textbf{r}}_x) + \sin(\tilde{\textbf{r}}_x) S) \). \( \tilde{\textbf{r}}_x = 2\pi(\textbf{r}/l_x) - \pi \). The symmetrization is done in order to preserve the Hermiticity of H. Units can be transformed by using the parameter \( \lambda \). </p>
<dl class="section note"><dt>Note</dt><dd>If the Hamiltonian is already in the prg_orthogonalized form, then parameter over_bml can be omitted. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">direction</td><td>Direction of the potential gradient (x,y or z). </td></tr>
    <tr><td class="paramname">lx</td><td>Lenght of the box in x direction. </td></tr>
    <tr><td class="paramname">coordinate</td><td>Coordinates of the system ( \( \textbf{r}\)). </td></tr>
    <tr><td class="paramname">lambda</td><td>Constant to premultiply the perturbation ( \( \lambda\)). </td></tr>
    <tr><td class="paramname">prt_bml</td><td>Perturbation in bml format ( \( H^{(1)} \)). </td></tr>
    <tr><td class="paramname">threshold</td><td>Threshold value for bml format matrices. </td></tr>
    <tr><td class="paramname">norbi</td><td>Number of orbitals for each atomic site. </td></tr>
    <tr><td class="paramname">verbose</td><td>Different levels of verbosity. </td></tr>
    <tr><td class="paramname">over_bml</td><td>It has to be present for a nonorthogonal representation ( \( S \)). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00594">594</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="ad6387373bee0a849be23b033fb6e06a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6387373bee0a849be23b033fb6e06a9">&#9670;&nbsp;</a></span>prg_pert_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_pert_from_file </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>prt_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>norb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read perturbation from file. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>Add read perturbation from file </dd></dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00226">226</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="aa81110bed4e09f0f488040123b5a7458"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa81110bed4e09f0f488040123b5a7458">&#9670;&nbsp;</a></span>prg_pert_sin_pot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_pert_sin_pot </td>
          <td>(</td>
          <td class="paramtype">character&#160;</td>
          <td class="paramname"><em>direction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>lx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>coordinate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>lambda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>prt_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>)&#160;</td>
          <td class="paramname"><em>threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>spindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>norbi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(in), optional&#160;</td>
          <td class="paramname"><em>over_bml</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a sinusoidal length dependent potential ( \( \sin(\tilde{\textbf{r}}_x) \)) where \( \textbf{r}_x \) is the x coordinate. The Hamiltonian gets modified as follows: \( H^{(1)} = \frac{1}{2}\lambda (S \sin(\tilde{\textbf{r}}_x) + \sin(\tilde{\textbf{r}}_x) S) \). \( \tilde{\textbf{r}}_x = 2\pi(\textbf{r}/l_x) - \pi \). The symmetrization is done in order to preserve the Hermiticity of H. Units can be transformed by using the parameter \( \lambda \). </p>
<dl class="section note"><dt>Note</dt><dd>If the Hamiltonian is already in the prg_orthogonalized form, then parameter over_bml can be omitted. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">direction</td><td>Direction of the potential gradient (x,y or z). </td></tr>
    <tr><td class="paramname">lx</td><td>Length of the box in x direction. </td></tr>
    <tr><td class="paramname">coordinate</td><td>Coordinates of the system ( \( \textbf{r}\)). </td></tr>
    <tr><td class="paramname">lambda</td><td>Constant to premultiply the perturbation ( \( \lambda\)). </td></tr>
    <tr><td class="paramname">prt_bml</td><td>Perturbation in bml format ( \( H^{(1)} \)). </td></tr>
    <tr><td class="paramname">threshold</td><td>Threshold value for bml format matrices. </td></tr>
    <tr><td class="paramname">norbi</td><td>Number of orbitals for each atomic site. </td></tr>
    <tr><td class="paramname">verbose</td><td>Different levels of verbosity. </td></tr>
    <tr><td class="paramname">over_bml</td><td>It has to be present for a nonorthogonal representation ( \( S \)). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00526">526</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a0f0b5ad483a44861c9027f2d52bc947c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f0b5ad483a44861c9027f2d52bc947c">&#9670;&nbsp;</a></span>prg_project_response()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_project_response </td>
          <td>(</td>
          <td class="paramtype">type(bml_matrix_t), intent(inout)&#160;</td>
          <td class="paramname"><em>rsp_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(bml_matrix_t), intent(in)&#160;</td>
          <td class="paramname"><em>over_bml</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>spindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>norbi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>coordinates</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>rspfunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Project the response onto atomic positions. First order response to the perturbation ( \( \rho^{(1)} \)) projected onto the atomic position. Basically: \( rsp(i) = \sum_{\alpha \in i}\rho^{(1)}_{\alpha \alpha} \), where orbital \( \alpha \) belong to atom \( i \). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rsp_bml</td><td>First order response density matrix. </td></tr>
    <tr><td class="paramname">spindex</td><td>It gives the species index of a particular atom. </td></tr>
    <tr><td class="paramname">norbi</td><td>Number of orbitals of species i. </td></tr>
    <tr><td class="paramname">coordinates</td><td>Atomic coordinates. </td></tr>
    <tr><td class="paramname">rspfunc</td><td>Response function at atomic positions. </td></tr>
    <tr><td class="paramname">verbose</td><td>Different levels of verbosity. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00798">798</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a558711d6f3342ea57458617c25c8b05c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a558711d6f3342ea57458617c25c8b05c">&#9670;&nbsp;</a></span>prg_write_dipole_tcl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public prg_response_mod::prg_write_dipole_tcl </td>
          <td>(</td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), dimension(3), intent(in)&#160;</td>
          <td class="paramname"><em>dipoleMoment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in)&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), intent(in)&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>verbose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To visualize a dipole moment using VMD. This will prg_generate a .tcl script that could be run using VMD To visualize with VMD: $ vmd -e dipole.tcl. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dipoleMoment</td><td>Dipole moment vector. </td></tr>
    <tr><td class="paramname">file</td><td>PDB/XYZ file to load for visualization. </td></tr>
    <tr><td class="paramname">factor</td><td>Arbitrary scale for visualization. </td></tr>
    <tr><td class="paramname">verbose</td><td>To give different verbosity levels. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00161">161</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af4d04d47039bc578b2566855bdc94a1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4d04d47039bc578b2566855bdc94a1e">&#9670;&nbsp;</a></span>dp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter prg_response_mod::dp = kind(1.0d0)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00018">18</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
<a id="a11f1b497aa371e1f745c7cf01766665c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11f1b497aa371e1f745c7cf01766665c">&#9670;&nbsp;</a></span>pi</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(<a class="el" href="namespaceprg__response__mod.html#af4d04d47039bc578b2566855bdc94a1e">dp</a>), parameter prg_response_mod::pi = 3.14159265358979323846264338327950_dp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="prg__response__mod_8F90_source.html#l00019">19</a> of file <a class="el" href="prg__response__mod_8F90_source.html">prg_response_mod.F90</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceprg__response__mod.html">prg_response_mod</a></li>
    <li class="footer">Generated on Wed Jul 12 2023 09:21:20 for progress by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
